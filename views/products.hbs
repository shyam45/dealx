<div class="container mt-5 pt-3 m-0">
    {{#if filterResult}}
    <div class="row pt-4">
        <div class="col-lg-3 pl-5">
            <div class="">
                <form action="" id="productFilter" method="post">
                    <div class="row">
                        <div class="col-md-6 col-lg-12 mb-5">
                            <h5 class="font-weight-bold dark-grey-text"><strong>Popular Cities</strong></h3>
                                <div class="divider"></div>
                                <input type="checkbox" name="city" value="" class="form-check-input" checked hidden>
                                <div class="form-check my-4">
                                    <input type="checkbox" name="city" value="trivandrum" class="form-check-input"
                                        id="Trivandrum">
                                    <label class="form-check-label" for="Trivandrum">Trivandrum</label>
                                </div>
                                <div class="form-check my-4">
                                    <input type="checkbox" name="city" value="kochi" class="form-check-input"
                                        id="Kochi">
                                    <label class="form-check-label" for="Kochi">Kochi</label>
                                </div>
                                <div class="form-check my-4">
                                    <input type="checkbox" name="city" value="thrissur" class="form-check-input"
                                        id="Thrissur">
                                    <label class="form-check-label" for="Thrissur">Thrissur</label>
                                </div>
                                <div class="form-check my-4">
                                    <input type="checkbox" name="city" value="malappuram" class="form-check-input"
                                        id="Malappuram">
                                    <label class="form-check-label" for="Malappuram">Malappuram</label>
                                </div>
                                <div class="form-check my-4">
                                    <input type="checkbox" name="city" value="calicut" class="form-check-input"
                                        id="Calicut">
                                    <label class="form-check-label" for="Calicut">Calicut</label>
                                </div>
                        </div>
                        <div class="col-md-6 col-lg-12 mb-5">
                            <h5 class="font-weight-bold dark-grey-text"><strong>Price</strong></h3>
                                <div class="divider"></div>
                                <div class="d-flex my-4">
                                    <h6 class="text-align-center pt-2" style="width: fit-content;">Min Price
                                    </h6>
                                    <input type="number" name="price" value="0" class="ml-3" style="width:100px">
                                </div>
                                <div class="d-flex my-4">
                                    <h6 class="text-align-center pt-2" style="width: fit-content;">Max Price
                                    </h6>
                                    <input type="number" name="price" value="100000" class="ml-3" style="width:100px">
                                </div>
                        </div>

                    </div>
            </div>
        </div>

        <div class="col-lg-9">
            <select class="form-control" style="width: 10rem ; margin-left: auto;" name="sort" id="sortMenu">
                <option value="sort">Default</option>
                <option value="lh">Price: low to high</option>
                <option value="hl"> Price: high to low</option>
            </select>
            </form>
            <div id="products">
                <section class="section pt-4">
                    
                    <h5 class="font-weight-bold dark-grey-text"><strong>
                            Category
                        </strong></h3>
                        <div class="divider"></div>
                        <div class="row">
                            {{#each filterResult}}
                            <div class="col-lg-3 col-md-6 mb-4" onclick="location.href='/product/{{this._id}}'">
                                <div class="card card-ecommerce">
                                    <div class="view overlay">
                                        <img src="/images/product-images/{{this.p_id}}(1).jpg" alt=""
                                                class="img-fluid" alt="">
                                        <a>
                                            <div class="mask rgba-white-slight"></div>
                                        </a>
                                    </div>
                                    <div class="card-body">
                                        <h5 class="card-title mb-1"><strong><a href=""
                                                    class="dark-grey-text text-decoration-none">{{this.product.name}}</a></strong>
                                        </h5><span class="badge badge-danger mb-3">bestseller</span>
                                        <div class="card-footer pb-0">
                                            <div class="row mb-0 d-flex">
                                                <span class="float-left" style="width: fit-content;"><strong>₹
                                                        {{this.product.price}}</strong></span>
                                                <span class="float-right ml-4" style="width: fit-content"> <a>
                                                        <i class="bx bx-heart text-warning fs-5"></i></a>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {{/each}}
                        </div>
                        {{/if}}
                        {{#if favorites}}
                        <div style="padding-top: 7rem; width:80%; margin: auto;">
                        <h5 class="font-weight-bold dark-grey-text"><strong>
                                Favorites
                            </strong></h5>
                            <div class="divider"></div>
                            <div class="row">
                                {{#each favorites}}
                                <div class="col-lg-3 col-md-6 mb-4" onclick="location.href='/product/{{this.p_id}}'">
                                    <div class="card card-ecommerce">
                                        <div class="view overlay">
                                            <img src="/images/product-images/{{this.p_id}}(1).jpg" alt=""
                                                class="img-fluid" alt="">
                                            <a>
                                                <div class="mask rgba-white-slight"></div>
                                            </a>
                                        </div>
                                        <div class="card-body">
                                            <h5 class="card-title mb-1"><strong><a href=""
                                                        class="dark-grey-text text-decoration-none">{{this.name}}</a></strong>
                                            </h5><span class="badge badge-danger mb-3">bestseller</span>
                                            <div class="card-footer pb-0">
                                                <div class="row mb-0 d-flex">
                                                    <span class="float-left" style="width: fit-content;"><strong>₹
                                                            {{this.price}}</strong></span>
                                                    <a href="/delete-favorite/{{this.f_id}}" class="float-right ml-4"
                                                        style="width: 1rem"><i
                                                            class="bx bx-block text-danger fs-5"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {{/each}}
                            </div>
                            </div>
                            {{/if}}

                        
                            {{!-- <div class="row justify-content-center mb-4 bottom-0">
                                <nav class="mb-4">
                                    <ul class="pagination pagination-circle pg-blue mb-0">
                                        <li class="page-item disabled clearfix d-none d-md-block"><a
                                                class="page-link waves-effect waves-effect">First</a></li>
                                        <li class="page-item disabled">
                                            <a class="page-link waves-effect waves-effect" aria-label="Previous">
                                                <span aria-hidden="true">«</span>
                                                <span class="sr-only">Previous</span>
                                            </a>
                                        </li>
                                        <li class="page-item active"><a
                                                class="page-link waves-effect waves-effect">1</a></li>
                                        <li class="page-item"><a class="page-link waves-effect waves-effect">2</a></li>
                                        <li class="page-item"><a class="page-link waves-effect waves-effect">3</a></li>
                                        <li class="page-item"><a class="page-link waves-effect waves-effect">4</a></li>
                                        <li class="page-item"><a class="page-link waves-effect waves-effect">5</a></li>
                                        <li class="page-item">
                                            <a class="page-link waves-effect waves-effect" aria-label="Next">
                                                <span aria-hidden="true">»</span>
                                                <span class="sr-only">Next</span>
                                            </a>
                                        </li>
                                        <li class="page-item clearfix d-none d-md-block"><a
                                                class="page-link waves-effect waves-effect">Last</a></li>
                                    </ul>
                                </nav>
                            </div> --}}
                </section>
            </div>
        </div>

    </div>

    <script>
        $('input[name="city"]').change(function () {
            $.ajax({
                url: '/products/filter',
                method: "post",
                data: $('#productFilter').serialize(),
                success: (isResult) => {
                    if (isResult) {
                        //window.location.reload()
                        // $('#products').load('/products/filter');
                        $('#products').load(location.href + " #products");
                    }
                }
            })

        });

        $('input[name="price"]').change(function () {
            $.ajax({
                url: '/products/filter',
                method: "post",
                data: $('#productFilter').serialize(),
                success: (isResult) => {
                    if (isResult) {
                        console.log(isResult
                        )
                        // window.location.reload()
                        // $('#products').load('/products/filter');
                        $('#products').load(location.href + " #products");
                    }
                }
            })

        });


        $('#sortMenu').on('change', function () {
            $.ajax({
                url: '/products/filter',
                method: "post",
                data: $('#productFilter').serialize(),
                success: (isResult) => {
                    if (isResult) {
                        console.log(isResult)
                        // window.location.reload()
                        // $('#products').load('/products/filter');
                        $('#products').load(location.href + " #products");
                    }
                }
            })
        });
    </script>